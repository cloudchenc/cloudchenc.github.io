---
title: leetcode-207-è¯¾ç¨‹è¡¨
date: 2021-03-16 11:54:02
tags:
    - å›¾
    - æ‹“æ‰‘æ’åº
    - å¹¿åº¦ä¼˜å…ˆæœç´¢
    - æ·±åº¦ä¼˜å…ˆæœç´¢
categories: leetcode
---

```
//ä½ è¿™ä¸ªå­¦æœŸå¿…é¡»é€‰ä¿® numCourses é—¨è¯¾ç¨‹ï¼Œè®°ä¸º 0 åˆ° numCourses - 1 ã€‚ 
//
// åœ¨é€‰ä¿®æŸäº›è¯¾ç¨‹ä¹‹å‰éœ€è¦ä¸€äº›å…ˆä¿®è¯¾ç¨‹ã€‚ å…ˆä¿®è¯¾ç¨‹æŒ‰æ•°ç»„ prerequisites ç»™å‡ºï¼Œå…¶ä¸­ prerequisites[i] = [ai, bi] ï¼Œè¡¨
//ç¤ºå¦‚æœè¦å­¦ä¹ è¯¾ç¨‹ ai åˆ™ å¿…é¡» å…ˆå­¦ä¹ è¯¾ç¨‹ bi ã€‚ 
//
// 
// ä¾‹å¦‚ï¼Œå…ˆä¿®è¯¾ç¨‹å¯¹ [0, 1] è¡¨ç¤ºï¼šæƒ³è¦å­¦ä¹ è¯¾ç¨‹ 0 ï¼Œä½ éœ€è¦å…ˆå®Œæˆè¯¾ç¨‹ 1 ã€‚ 
// 
//
// è¯·ä½ åˆ¤æ–­æ˜¯å¦å¯èƒ½å®Œæˆæ‰€æœ‰è¯¾ç¨‹çš„å­¦ä¹ ï¼Ÿå¦‚æœå¯ä»¥ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚ 
//
// 
//
// ç¤ºä¾‹ 1ï¼š 
//
// 
//è¾“å…¥ï¼šnumCourses = 2, prerequisites = [[1,0]]
//è¾“å‡ºï¼štrue
//è§£é‡Šï¼šæ€»å…±æœ‰ 2 é—¨è¯¾ç¨‹ã€‚å­¦ä¹ è¯¾ç¨‹ 1 ä¹‹å‰ï¼Œä½ éœ€è¦å®Œæˆè¯¾ç¨‹ 0 ã€‚è¿™æ˜¯å¯èƒ½çš„ã€‚ 
//
// ç¤ºä¾‹ 2ï¼š 
//
// 
//è¾“å…¥ï¼šnumCourses = 2, prerequisites = [[1,0],[0,1]]
//è¾“å‡ºï¼šfalse
//è§£é‡Šï¼šæ€»å…±æœ‰ 2 é—¨è¯¾ç¨‹ã€‚å­¦ä¹ è¯¾ç¨‹ 1 ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®Œæˆâ€‹è¯¾ç¨‹ 0 ï¼›å¹¶ä¸”å­¦ä¹ è¯¾ç¨‹ 0 ä¹‹å‰ï¼Œä½ è¿˜åº”å…ˆå®Œæˆè¯¾ç¨‹ 1 ã€‚è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚ 
//
// 
//
// æç¤ºï¼š 
//
// 
// 1 <= numCourses <= 105 
// 0 <= prerequisites.length <= 5000 
// prerequisites[i].length == 2 
// 0 <= ai, bi < numCourses 
// prerequisites[i] ä¸­çš„æ‰€æœ‰è¯¾ç¨‹å¯¹ äº’ä¸ç›¸åŒ 
// 
// Related Topics æ·±åº¦ä¼˜å…ˆæœç´¢ å¹¿åº¦ä¼˜å…ˆæœç´¢ å›¾ æ‹“æ‰‘æ’åº 
// ğŸ‘ 742 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)

//leetcode submit region end(Prohibit modification and deletion)
```

## å¹¿åº¦ä¼˜å…ˆæœç´¢

```
1. ç»Ÿè®¡è¯¾ç¨‹å®‰æ’å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦ï¼Œç”Ÿæˆ **å…¥åº¦è¡¨** `indegrees`ã€‚
2. å€ŸåŠ©ä¸€ä¸ªé˜Ÿåˆ— `queue`ï¼Œå°†æ‰€æœ‰å…¥åº¦ä¸º *0* çš„èŠ‚ç‚¹å…¥é˜Ÿã€‚
3. å½“ `queue` éç©ºæ—¶ï¼Œä¾æ¬¡å°†é˜Ÿé¦–èŠ‚ç‚¹å‡ºé˜Ÿï¼Œåœ¨è¯¾ç¨‹å®‰æ’å›¾ä¸­åˆ é™¤æ­¤èŠ‚ç‚¹ `pre`ï¼š
   - å¹¶ä¸æ˜¯çœŸæ­£ä»é‚»æ¥è¡¨ä¸­åˆ é™¤æ­¤èŠ‚ç‚¹ `pre`ï¼Œè€Œæ˜¯å°†æ­¤èŠ‚ç‚¹å¯¹åº”æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹ `cur` çš„å…¥åº¦ *-1*ï¼Œå³ `indegrees[cur] -= 1`ã€‚
   - å½“å…¥åº¦ *-1*åé‚»æ¥èŠ‚ç‚¹ `cur` çš„å…¥åº¦ä¸º *0*ï¼Œè¯´æ˜ `cur` æ‰€æœ‰çš„å‰é©±èŠ‚ç‚¹å·²ç»è¢« â€œåˆ é™¤â€ï¼Œæ­¤æ—¶å°† `cur` å…¥é˜Ÿã€‚
4. åœ¨æ¯æ¬¡ `pre` å‡ºé˜Ÿæ—¶ï¼Œæ‰§è¡Œ `numCourses--`ï¼›
   - è‹¥æ•´ä¸ªè¯¾ç¨‹å®‰æ’å›¾æ˜¯æœ‰å‘æ— ç¯å›¾ï¼ˆå³å¯ä»¥å®‰æ’ï¼‰ï¼Œåˆ™æ‰€æœ‰èŠ‚ç‚¹ä¸€å®šéƒ½å…¥é˜Ÿå¹¶å‡ºé˜Ÿè¿‡ï¼Œå³å®Œæˆæ‹“æ‰‘æ’åºã€‚æ¢ä¸ªè§’åº¦è¯´ï¼Œè‹¥è¯¾ç¨‹å®‰æ’å›¾ä¸­å­˜åœ¨ç¯ï¼Œä¸€å®šæœ‰èŠ‚ç‚¹çš„å…¥åº¦å§‹ç»ˆä¸ä¸º *0*ã€‚
   - å› æ­¤ï¼Œæ‹“æ‰‘æ’åºå‡ºé˜Ÿæ¬¡æ•°ç­‰äºè¯¾ç¨‹ä¸ªæ•°ï¼Œè¿”å› `numCourses == 0` åˆ¤æ–­è¯¾ç¨‹æ˜¯å¦å¯ä»¥æˆåŠŸå®‰æ’ã€‚
```

```java 
// BFS
class Solution {
    public boolean canFinish(int numCourses, int[][] prerequisites) {
        if (numCourses <= 0) return new int[0];

        List<List<Integer>> adjacency = new ArrayList<>(); // æ„å»ºé‚»æ¥è¡¨
        for (int i = 0; i < numCourses; i++)
            adjacency.add(new ArrayList<>());

        int[] inDegrees = new int[numCourses]; // ä¿å­˜èŠ‚ç‚¹çš„å…¥åº¦
        for (int[] p : prerequisites) {
            inDegrees[p[0]]++; // è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦
            adjacency.get(p[1]).add(p[0]); // ä¿å­˜å‡ºåº¦çš„èŠ‚ç‚¹
        }

        Queue<Integer> queue = new LinkedList<>(); 
        for (int i = 0; i < numCourses; i++)
            if (inDegrees[i] == 0) queue.offer(i); // ä¿å­˜å…¥åº¦ä¸º0çš„èŠ‚ç‚¹

        while (!queue.isEmpty()) {
            int pre = queue.poll();
            numCourses--; // å‰ªæ
            for (int cur : adjacency.get(pre))
                if (--inDegrees[cur] == 0) queue.offer(cur); // å‰”é™¤å‰é©±èŠ‚ç‚¹ï¼Œå¯¹åº”æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹å…¥åº¦-1
        }
        return numCourses == 0;
    }
}
```
    æ—¶é—´å¤æ‚åº¦ï¼šO(N + M), éå†ä¸€ä¸ªå›¾éœ€è¦è®¿é—®æ‰€æœ‰èŠ‚ç‚¹å’Œæ‰€æœ‰ä¸´è¾¹ï¼ŒN å’Œ M åˆ†åˆ«ä¸ºèŠ‚ç‚¹æ•°é‡å’Œä¸´è¾¹æ•°é‡
    ç©ºé—´å¤æ‚åº¦ï¼šO(N + M), ä¸ºå»ºç«‹é‚»æ¥è¡¨æ‰€éœ€é¢å¤–ç©ºé—´ï¼Œadjacency é•¿åº¦ä¸º Nï¼Œå¹¶å­˜å‚¨ M æ¡ ä¸´è¾¹çš„æ•°æ®
    æ‰§è¡Œè€—æ—¶:6 ms,å‡»è´¥äº†51.10% çš„Javaç”¨æˆ·
    å†…å­˜æ¶ˆè€—:39.3 MB,å‡»è´¥äº†40.25% çš„Javaç”¨æˆ·
    
## æ·±åº¦ä¼˜å…ˆæœç´¢

åŸç†æ˜¯é€šè¿‡ DFS åˆ¤æ–­å›¾ä¸­æ˜¯å¦æœ‰ç¯ã€‚

```
1. å€ŸåŠ©ä¸€ä¸ªæ ‡å¿—åˆ—è¡¨ `flags`ï¼Œç”¨äºåˆ¤æ–­æ¯ä¸ªèŠ‚ç‚¹ `i` ï¼ˆè¯¾ç¨‹ï¼‰çš„çŠ¶æ€ï¼š
   1. æœªè¢« DFS è®¿é—®ï¼š`i == 0`ï¼›
   2. å·²è¢«**å…¶ä»–èŠ‚ç‚¹å¯åŠ¨**çš„ DFS è®¿é—®ï¼š`i == -1`ï¼›
   3. å·²è¢«**å½“å‰èŠ‚ç‚¹å¯åŠ¨**çš„ DFS è®¿é—®ï¼š`i == 1`ã€‚
2. å¯¹ `numCourses` ä¸ªèŠ‚ç‚¹ä¾æ¬¡æ‰§è¡Œ DFSï¼Œåˆ¤æ–­æ¯ä¸ªèŠ‚ç‚¹èµ·æ­¥ DFS æ˜¯å¦å­˜åœ¨ç¯ï¼Œè‹¥å­˜åœ¨ç¯ç›´æ¥è¿”å› *False*ã€‚DFS æµç¨‹ï¼›
   1. ç»ˆæ­¢æ¡ä»¶ï¼š
      - å½“ `flag[i] == -1`ï¼Œè¯´æ˜å½“å‰è®¿é—®èŠ‚ç‚¹å·²è¢«å…¶ä»–èŠ‚ç‚¹å¯åŠ¨çš„ DFS è®¿é—®ï¼Œæ— éœ€å†é‡å¤æœç´¢ï¼Œç›´æ¥è¿”å› *True*ã€‚
      - å½“ `flag[i] == 1`ï¼Œè¯´æ˜åœ¨æœ¬è½® DFS æœç´¢ä¸­èŠ‚ç‚¹ `i` è¢«ç¬¬ *2* æ¬¡è®¿é—®ï¼Œå³ **è¯¾ç¨‹å®‰æ’å›¾æœ‰ç¯** ï¼Œç›´æ¥è¿”å› *False*ã€‚
   2. å°†å½“å‰è®¿é—®èŠ‚ç‚¹ `i` å¯¹åº” `flag[i]` ç½® *1*ï¼Œå³æ ‡è®°å…¶è¢«æœ¬è½® DFS è®¿é—®è¿‡ï¼›
   3. é€’å½’è®¿é—®å½“å‰èŠ‚ç‚¹ `i` çš„æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹ `j`ï¼Œå½“å‘ç°ç¯ç›´æ¥è¿”å› *False*ï¼›
   4. å½“å‰èŠ‚ç‚¹æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹å·²è¢«éå†ï¼Œå¹¶æ²¡æœ‰å‘ç°ç¯ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹ `flag` ç½®ä¸º *-1* å¹¶è¿”å› *True*ã€‚
3. è‹¥æ•´ä¸ªå›¾ DFS ç»“æŸå¹¶æœªå‘ç°ç¯ï¼Œè¿”å› *True*ã€‚
```

```java 
// DFS
class Solution {
    public boolean canFinish(int numCourses, int[][] prerequisites) {
        List<List<Integer>> adjacency = new ArrayList<>();
        for (int i = 0; i < numCourses; i++)
            adjacency.add(new ArrayList<>());
        for (int[] p : prerequisites)
            adjacency.get(p[1]).add(p[0]);
        int[] flags = new int[numCourses];
        for (int i = 0; i < numCourses; i++)
            if (!dfs(adjacency, flags, i)) return false;
        return true;
    }

    public boolean dfs(List<List<Integer>> adjacency, int[] flags, int i) {
        if (flags[i] == 1) return false;
        if (flags[i] == -1) return true;
        flags[i] = 1;
        for (int j : adjacency.get(i))
            if (!dfs(adjacency, flags, j)) return false;
        flags[i] = -1;
        return true;
    }
}
```
    æ—¶é—´å¤æ‚åº¦ï¼šO(N + M), éå†ä¸€ä¸ªå›¾éœ€è¦è®¿é—®æ‰€æœ‰èŠ‚ç‚¹å’Œæ‰€æœ‰ä¸´è¾¹ï¼ŒN å’Œ M åˆ†åˆ«ä¸ºèŠ‚ç‚¹æ•°é‡å’Œä¸´è¾¹æ•°é‡
    ç©ºé—´å¤æ‚åº¦ï¼šO(N + M), ä¸ºå»ºç«‹é‚»æ¥è¡¨æ‰€éœ€é¢å¤–ç©ºé—´ï¼Œadjacency é•¿åº¦ä¸º Nï¼Œå¹¶å­˜å‚¨ M æ¡ ä¸´è¾¹çš„æ•°æ®
    æ‰§è¡Œè€—æ—¶:4 ms,å‡»è´¥äº†79.55% çš„Javaç”¨æˆ·
    å†…å­˜æ¶ˆè€—:38.8 MB,å‡»è´¥äº†82.85% çš„Javaç”¨æˆ·
    				